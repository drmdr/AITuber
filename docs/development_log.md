# 開発ログ

## 2025-06-25

### 1. キャラクター設定の反映と修正

- **問題点**: `AITuber.py` の `interactive_mode` において、Geminiモデルの初期化が不適切で、`config.local.json` に定義されたキャラクターのペルソナ（性格・口調）が会話に反映されていなかった。
- **修正内容**:
    - `interactive_mode` 内のモデル初期化処理をリファクタリングし、`system_instruction` としてキャラクターのペルソナ(`full_persona`)が正しく渡されるように修正した。
    - これにより、会話中の応答がキャラクター設定に沿ったものになることを確認した。

### 2. `config.local.json` の設定値の修正

- **問題点**: 過去の修正で、ユーザーの意図しない形で `config.local.json` が書き換えられ、キャラクター設定（AIと名乗らない、一人称、挨拶など）が失われていた。
- **修正内容**:
    - ユーザーからの指摘に基づき、`config.local.json` を再度修正。
    - **ペルソナ**: 「AI」という単語を削除。
    - **一人称**: 「ウチ」に統一。
    - **挨拶**: 「Gmonamin!」で始まる形式に統一。
    - **自己紹介**: 「AIチューバー」という記述を削除。
    - JSON構文エラー（コンマ不足）も併せて修正した。

### 3. 仕様書 (`docs/spec.md`) の更新

- **背景**: 今後の開発でキャラクター設定の逸脱を防ぐため、絶対的な指針として仕様書に明記する必要があった。
- **更新内容**:
    - 「3.1. キャラクター設定の厳守」セクションに、以下の詳細な定義とルールを追記した。
        - **基本設定**: 名前（モナミン）、一人称（ウチ）、口調（えせ関西弁）、挨拶の具体的な内容。
        - **絶対的な禁止・遵守事項**:
            1.  **AIと名乗らない**: AIやアシスタント等の自己言及の禁止。
            2.  **設定ファイルの尊重**: ユーザー指示なく `config` ファイルを変更することの禁止。
            3.  **キャラクター定義の優先**: 実装時は仕様書と設定ファイルを最優先とし、不明点はユーザーに確認すること。

### 4. 全体的な安定性の向上

- Gemini API TTSのクライアント初期化やインポート文など、プロジェクト全体でコードの品質と一貫性を向上させるための修正を複数実施した。

---

**今後の課題**: 
- 言語選択システムの安定性向上（batファイルの分割など）。
- 過去のミスを繰り返さないためのレビュー体制の構築。
